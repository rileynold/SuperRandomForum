CREATE TABLE User_Groups(
    GroupID INTEGER NOT NULL PRIMARY KEY AUTO_INCREMENT,
    Name VARCHAR(128) NOT NULL
);

CREATE TABLE Users(
    UserID INTEGER NOT NULL PRIMARY KEY AUTO_INCREMENT,
    Username VARCHAR(128) UNIQUE NOT NULL,
    EncryptedPassword VARCHAR(128) NOT NULL,
    Email VARCHAR(128) NOT NULL,
    GroupID INTEGER NOT NULL,
    CONSTRAINT FOREIGN KEY (GroupID) REFERENCES User_Groups(GroupID)
);

CREATE TABLE Forums(
    ForumID INTEGER NOT NULL PRIMARY KEY AUTO_INCREMENT
);

CREATE TABLE Permissions(
    GroupID INTEGER NOT NULL,
    ForumID INTEGER NOT NULL,
    CONSTRAINT PRIMARY KEY (GroupID, ForumID),
    CONSTRAINT FOREIGN KEY (GroupID) REFERENCES User_Groups(GroupID),
    CONSTRAINT FOREIGN KEY (ForumID) REFERENCES Forums(ForumID)
);

CREATE TABLE Moderators(
    UserID INTEGER NOT NULL,
    ForumID INTEGER NOT NULL,
    CONSTRAINT PRIMARY KEY (UserID, ForumID),
    CONSTRAINT FOREIGN KEY (UserID) REFERENCES Users(UserID),
    CONSTRAINT FOREIGN KEY (ForumID) REFERENCES Forums(ForumID)
);

CREATE TABLE Private_Messages(
    MessageID INTEGER NOT NULL PRIMARY KEY AUTO_INCREMENT,
    SenderID INTEGER NOT NULL,
    ReceiverID INTEGER NOT NULL,
    Subject VARCHAR(128) NOT NULL,
    Content VARCHAR(2000) NOT NULL,
    DateSent DATETIME NOT NULL,
    CONSTRAINT FOREIGN KEY (SenderID) REFERENCES Users(UserID),
    CONSTRAINT FOREIGN KEY (ReceiverID) REFERENCES Users(UserID)
);

CREATE TABLE Threads(
    ThreadID INTEGER NOT NULL PRIMARY KEY AUTO_INCREMENT,
    ViewCount INTEGER NOT NULL,
    ForumID INTEGER,
    CONSTRAINT FOREIGN KEY (ForumID) REFERENCES Forums(ForumID)
);

CREATE TABLE Posts(
    PostID INTEGER NOT NULL PRIMARY KEY AUTO_INCREMENT,
    Subject VARCHAR(128) NOT NULL,
    Content VARCHAR(3000) NOT NULL,
    DateCreated DATETIME NOT NULL,
    CreatorID INTEGER NOT NULL,
    ThreadID INTEGER NOT NULL,
    CONSTRAINT FOREIGN KEY (CreatorID) REFERENCES Users(UserID),
    CONSTRAINT FOREIGN KEY (ThreadID) REFERENCES Threads(ThreadID)
);
